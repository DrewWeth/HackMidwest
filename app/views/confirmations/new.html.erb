<h1>New confirmation</h1>

<% if params[:event_id].present?
		#puts "************************** EVENT ID "<< params[:event_id].to_s
		e = Event.find(params[:event_id])
		cookies['event_lat_long'] = {
		  :value => e.latitude.to_s << "|" << e.longitude.to_s
		}
	end %>

<% if flash[:message] %>
    <div style="color:red" class="notice"><%= flash[:message] %></div>
<% end %>

<%= render 'form' %>

<%= link_to 'Back', confirmations_path %>

<%- unless @user_lat_lng %>
<script>
  TestGeo();

	function TestGeo()
	    {
	         if (navigator.geolocation) 
	            {
	              navigator.geolocation.getCurrentPosition( TestMap, error, {maximumAge: 30000, timeout: 10000, enableHighAccuracy: true} );
	        }
	        else
	        {
	              alert("Sorry, but it looks like your browser does not support geolocation.");
	        }
	    }

	function TestMap(position) {
		var latitude = position.coords.latitude;
		var longitude = position.coords.longitude;  
		//alert("Your coordinates are " + position.coords.latitude + ", " + position.coords.longitude);
		// log to cookie
		document.cookie="user_lat_long=" + position.coords.latitude + "|" + position.coords.longitude;
		}
		console.log(document.cookie);
		
	function error() {
			alert("Cannot locate user");
			}

</script>
<%- end %>
